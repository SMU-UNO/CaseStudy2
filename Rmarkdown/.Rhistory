title: "R Case Study2"
output: html_document
---
##Your team has been given a dataset (CaseStudy2Data.zip) to conduct exploratory data analysis (EDA) to determine factors that lead to attrition. You should identify (at least) the top three factors that contribute to turnover. There may or may not be a need to create derived attributes/variables. The business is also interested in learning about any job role specific trends that may exist in the data set (e.g., âData Scientists have the highest job satisfactionâ). You can also provide any other interesting trends and observations from your analysis. The analysis should be backed up by robust experimentation and (where applicable) appropriate visualization. Experiments and analysis must be conducted in R. If needed, consult with the business owner to get clarifications on the dataset or business goals.
```{r}
employee <- read.csv(file = "/Users/afreensiddiqui/myhome/SMU/R/MSDS6306/RgitRepo/CaseStudy2files/employeeData.csv", header=TRUE, sep=",")
head(employee)
#Drop the the columns with no variability.
#Drop Over18 as there is no variability, all are Y.
#Drop EmployeeCount as there is no variability, all are 1.
#Drop StandardHours as there is no variability, all are 80.
library(caret)
nearZeroVar(employee)
employee$Over18 <- NULL
employee$EmployeeCount <- NULL
employee$StandardHours <- NULL
```
#Exploratory Data Analysis
#Attrition
```{r}
table(employee$Attrition)
prop.table(table(employee$Attrition))
ggplot(employee, aes(Attrition, fill=factor(Attrition))) + geom_bar()
```
#OverTime
```{r}
prop.table(table(employee$OverTime))
table(employee$OverTime, employee$Attrition)
ggplot(employee, aes(OverTime, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#Overall 28% of the employees are putting overtime. The percentage of attrition amongst those putting in overtime is close to 44% (127/289) vs 11% (110/944) for those not putting in overtime. Thus Overtime is contributing towards attrition.
```
#Monthly Income:
```{r}
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c(1,2,3,4,5,6,7,8,9,10))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
```
#TotalWorkingYears
```{r}
summary(employee$TotalWorkingYears)
TtlWkgYrs <- cut(employee$TotalWorkingYears, 10, include.lowest = TRUE)
ggplot(employee, aes(TtlWkgYrs, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#attrition decreases as the total number of working years increase. After an employee has spent 8-12 years in the company, his chances of attrition decrease.
```
#JobRole
```{r}
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme_minimal(axis.text.x=element_text(angle=90, hjust=1))
install.packages("caret")
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_dotplot(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
library(ggplot2)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_dotplot(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
---
title: "R Case Study2"
output: html_document
---
##Your team has been given a dataset (CaseStudy2Data.zip) to conduct exploratory data analysis (EDA) to determine factors that lead to attrition. You should identify (at least) the top three factors that contribute to turnover. There may or may not be a need to create derived attributes/variables. The business is also interested in learning about any job role specific trends that may exist in the data set (e.g., âData Scientists have the highest job satisfactionâ). You can also provide any other interesting trends and observations from your analysis. The analysis should be backed up by robust experimentation and (where applicable) appropriate visualization. Experiments and analysis must be conducted in R. If needed, consult with the business owner to get clarifications on the dataset or business goals.
```{r}
employee <- read.csv("https://raw.githubusercontent.com/SMU-UNO/CaseStudy2/master/RawData/CaseStudy2-data.csv", header=TRUE, sep=",")
head(employee)
#Drop the the columns with no variability.
#Drop Over18 as there is no variability, all are Y.
#Drop EmployeeCount as there is no variability, all are 1.
#Drop StandardHours as there is no variability, all are 80.
library(caret)
library(ggplot2)
nearZeroVar(employee)
employee$Over18 <- NULL
employee$EmployeeCount <- NULL
employee$StandardHours <- NULL
```
#Exploratory Data Analysis
#Attrition
```{r}
table(employee$Attrition)
prop.table(table(employee$Attrition))
ggplot(employee, aes(Attrition, fill=factor(Attrition))) + geom_bar()
```
#OverTime
```{r}
prop.table(table(employee$OverTime))
table(employee$OverTime, employee$Attrition)
ggplot(employee, aes(OverTime, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#Overall 28% of the employees are putting overtime. The percentage of attrition amongst those putting in overtime is close to 44% (127/289) vs 11% (110/944) for those not putting in overtime. Thus Overtime is contributing towards attrition.
```
#Monthly Income:
```{r}
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c(1,2,3,4,5,6,7,8,9,10))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
```
#TotalWorkingYears
```{r}
summary(employee$TotalWorkingYears)
TtlWkgYrs <- cut(employee$TotalWorkingYears, 10, include.lowest = TRUE)
ggplot(employee, aes(TtlWkgYrs, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#attrition decreases as the total number of working years increase. After an employee has spent 8-12 years in the company, his chances of attrition decrease.
```
#JobRole
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", size=1, color=c("Dark Grey", "Red"))
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", size=1)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", size=50)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color=c(1:2))
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="blue")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",. fill=c("Light Blue","Pink"))
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_continuous()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_continuous(low=#132B43, high=#56B1F7, guide="colourbvar")
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_continuous(low=#132B43, high=#56B1F7, guide="colourbar")
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_continuous(low=#132B43, high=#56B1F7, guide="colourbar"))
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_continuous(low=#132B43, high=#56B1F7, guide="colourbar")
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_continuous(low=#132B43, high=#56B1F7, guide="colourbar")
)
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_gradient()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_color_gradient()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey",)
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + scale_fill_gradient(low="red",high="yellow")
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey", aes(fill=fl))
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey", aes(fill=c("Dark Brown","Pink")))
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey", aes(fill=("Dark Brown","Pink")))
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey", aes(fill=c("Dark Brown","Pink")))
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey", aes(fill="Pink")))
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey", aes(fill="Pink"))
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey", aes(fill=factor(Attrition)))
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey")))
summary(employee$TotalWorkingYears)
TtlWkgYrs <- cut(employee$TotalWorkingYears, 10, include.lowest = TRUE)
ggplot(employee, aes(TtlWkgYrs, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#attrition decreases as the total number of working years increase. After an employee has spent 8-12 years in the company, his chances of attrition decrease.
summary(employee$TotalWorkingYears)
TtlWkgYrs <- cut(employee$TotalWorkingYears, 10, include.lowest = TRUE)
ggplot(employee, aes(TtlWkgYrs, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#attrition decreases as the total number of working years increase. After an employee has spent 8-12 years in the company, his chances of attrition decrease.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey"))
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey"))
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge", color="dark grey")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c(1,2,3,4,5,6,7,8,9,10))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = c("Dark Grey","Maroon"))) + geom_bar(position="dodge")
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c(10%,20%,30%,40%,50%,60%,70%,80%,90%,100%))
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_jitter(position="dodge")
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_dotplot(position="dodge")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_dotplot(position="dodge", binwidth = 25)
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_dotplot(position="dodge", binwidth = .01)
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_dotplot(position="dodge", binwidth = .5)
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_dotplot(position="dodge", binwidth = .05)
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_bw()
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_excel()
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_excel()
library(ggthemes)
help("ggthemes")
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_gdocs()
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_gdocs() + scale_color_gdocs()
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_solarized()
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_solarized2()
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_solarized(light=false)
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_solarized(light = FALSE)
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge") + theme_solarized(light = FALSE) + scale_colour_solarized("red")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome,fill = factor(Attrition))) + geom_bar(position="dodge") + theme_solarized(light = FALSE) + scale_colour_solarized("red")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar(position="dodge") + theme_solarized(light = FALSE) + scale_colour_solarized("red")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar(position="dodge") +  scale_fill_excel() +  theme_excel()
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%")) + xlab("Percentile of the Companies Employee Salaries") + ylab("Count of Employees")
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar(position="dodge") +  scale_fill_excel() +  theme_excel() + xlab("Percentile of the Companies Employee Salaries") + ylab("Count of Employees") + scale_x_reverse()
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar(position="dodge") +  scale_fill_excel() +  theme_excel()
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar(position="dodge") +  scale_fill_excel() +  theme_excel() + xlab("Percentile of the Companies Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_dotplot(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_polygon(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_text(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_point(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_area(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_calc() + scale_color_calc()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_calc() + scale_color_calc(...)
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_calc() + scale_color_calc("blue")
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_pander() + scale_colour_pander()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_pander() + scale_colour_pander()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_pander() + scale_fill_pander()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_few() + scale_colour_few()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_few() + scale_fill_few()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_few() + scale_fill_few()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_few() + scale_fill_cars()
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_few() + scale_colour_wsj("colors6", "")
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_few() +  scale_fill_pander()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
table(employee$EducationField)
table(employee$EducationField, employee$Attrition)
gplot2 <- ggplot(employee, aes(x = EducationField, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
gplot2 + theme(axis.text.x=element_text(angle=90, hjust=1))
#The company has more employees with education field LifeScience
ggplot(employee, aes(x=factor(Department), y=MonthlyIncome, color=factor(Attrition))) +
geom_boxplot() +
xlab("Department") +
ylab("Monthly income") +
scale_fill_discrete(guide=guide_legend(title="Attrition")) +
theme_bw()
summary(employee$TotalWorkingYears)
TtlWkgYrs <- cut(employee$TotalWorkingYears, 10, include.lowest = TRUE)
ggplot(employee, aes(TtlWkgYrs, fill = Attrition)) + geom_bar(position="dodge") + scale_fill_ptol() +  theme_minimal()
#attrition decreases as the total number of working years increase. After an employee has spent 8-12 years in the company, his chances of attrition decrease.
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, fill = Attrition)) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(hjust=1)) + coord_flip() + theme_igray() +  scale_fill_pander()
#Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
summary(employee$TotalWorkingYears)
TtlWkgYrs <- cut(employee$TotalWorkingYears, 10, include.lowest = TRUE)
ggplot(employee, aes(TtlWkgYrs, fill = Attrition)) + geom_bar(position="dodge") + scale_fill_ptol() +  theme_minimal() + xlab("Total Years in the Workforce") + ylab("Count of Employees")
#attrition decreases as the total number of working years increase. After an employee has spent 8-12 years in the company, his chances of attrition decrease.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar(position="stacked") +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = reorder(Attrition,-Attrition)) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = reorder(Attrition,-MnthlyIncome[Attrition])) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = order(Attrition,decreasing=FALSE) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = -Attrition) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = -Attrition) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c("10%","20%","30%","40%","50%","60%","70%","80%","90%","100%"))
ggplot(employee, aes(MnthlyIncome, fill = Attrition)) + geom_bar() +  scale_fill_excel() +  theme_excel() + xlab("Percentile of Our Company's Employee Salaries") + ylab("Count of Employees")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
Overtime <- AttritionData$Overtime
OvertimeAttrition <- data.frame(Overtime, Attrition)
barplot(table(OvertimeAttrition), col=c("lightblue","red"), beside=TRUE, xlab="Does the Employee Work Overtime?", ylab="Number of Employees", legend=c("Still at Company","Left the Company"))
Overtime <- AttritionData$Overtime
Overtime <- employee$Overtime
OvertimeAttrition <- data.frame(Overtime, Attrition)
barplot(table(OvertimeAttrition), col=c("lightblue","red"), beside=TRUE, xlab="Does the Employee Work Overtime?", ylab="Number of Employees", legend=c("Still at Company","Left the Company"))
barplot(table(employee$OverTime,employee$Attrition), col=c("lightblue","red"), beside=TRUE, xlab="Does the Employee Work Overtime?", ylab="Number of Employees", legend=c("Still at Company","Left the Company"))
barplot(table(employee$OverTime,employee$Attrition[employee$OverTime]), col=c("lightblue","red"), beside=TRUE, xlab="Does the Employee Work Overtime?", ylab="Number of Employees", legend=c("Still at Company","Left the Company"))
barplot(table(employee$OverTime,employee$Attrition[employee$OverTime=="Yes"]), col=c("lightblue","red"), beside=TRUE, xlab="Does the Employee Work Overtime?", ylab="Number of Employees", legend=c("Still at Company","Left the Company"))
library(ggplot2)
library(openxlsx)
AttritionData <- read.csv("https://raw.githubusercontent.com/SMU-UNO/CaseStudy2/master/RawData/CaseStudy2-data.csv")
AttritionData <- read.csv("C:\\Users\\bpkim\\OneDrive\\Desktop\\6306DoingDataScience\\CaseStudy2files\\CaseStudy2-data.csv")
AttritionData$Attrition2[AttritionData$Attrition == "Yes"] <- 1
AttritionData$Attrition2[AttritionData$Attrition == "No"] <- 0
AttritionData$Age <- AttritionData$ï..Age
AttritionDataUnder2Years <- subset(AttritionData, AttritionData$TotalWorkingYears<2)
AttritionDataOver11years <- subset(AttritionData, AttritionData$TotalWorkingYears>11)
AttritionData2to11years <- subset(AttritionData, AttritionData$TotalWorkingYears>2 & AttritionData$TotalWorkingYears<12)
agg<- (aggregate(Attrition2 ~ TotalWorkingYears, data=AttritionData, FUN=mean))
agg2<- (aggregate(Attrition2 ~ TotalWorkingYears, data=AttritionData, FUN=sum))
ggplot(data=agg, aes(x=TotalWorkingYears, y=Attrition2))+ geom_bar(stat="identity", color="blue",fill="grey")+labs(title="Percentage Turnover Rate by Year Experience", x="Employee Total Working Years",y="Percentage of Employee Turnover")
ggplot(data=agg2, aes(x=TotalWorkingYears, y=Attrition2))+ geom_bar(stat="identity", color="red",fill="grey")+labs(title="Total Turnover by Year Experience", x="Employee Total Working Years",y="Number of Employees Who Left the Firm")
library(dygraphs)
AT <- table(AttritionData[,1:2])
AT2 <- as.data.frame.matrix(AT)
Ages<-c(18:60)
AT3<-data.frame(Ages,AT2)
dygraph(AT3, xlab="Age", ylab="Number of Employees") %>%
dySeries("Yes", label = "Left the Company") %>%
dySeries("No", label = "Still Employed")
dygraph(AT3, xlab="Age", ylab="Number of Employees") %>%
dySeries("Yes", label = "Left the Company") %>%
dySeries("No", label = "Still Employed") %>%
dyShading(from = "26", to = "35", color = "#FFE6E6")
