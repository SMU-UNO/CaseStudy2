---
title: "R Case Study2"
output: html_document
---

##Your team has been given a dataset (CaseStudy2Data.zip) to conduct exploratory data analysis (EDA) to determine factors that lead to attrition. You should identify (at least) the top three factors that contribute to turnover. There may or may not be a need to create derived attributes/variables. The business is also interested in learning about any job role specific trends that may exist in the data set (e.g., “Data Scientists have the highest job satisfaction”). You can also provide any other interesting trends and observations from your analysis. The analysis should be backed up by robust experimentation and (where applicable) appropriate visualization. Experiments and analysis must be conducted in R. If needed, consult with the business owner to get clarifications on the dataset or business goals.

```{r}
employee <- read.csv(file = "/Users/afreensiddiqui/myhome/SMU/R/MSDS6306/RgitRepo/CaseStudy2files/employeeData.csv", header=TRUE, sep=",")
head(employee)



#Drop the the columns with no variability.

#Drop Over18 as there is no variability, all are Y.
#Drop EmployeeCount as there is no variability, all are 1.
#Drop StandardHours as there is no variability, all are 80.

library(caret)
nearZeroVar(employee) 
employee$Over18 <- NULL
employee$EmployeeCount <- NULL
employee$StandardHours <- NULL
```
#Exploratory Data Analysis
#Attrition

```{r}
table(employee$Attrition)
prop.table(table(employee$Attrition))
ggplot(employee, aes(Attrition, fill=factor(Attrition))) + geom_bar()
```

#OverTime
```{r}



prop.table(table(employee$OverTime))
table(employee$OverTime, employee$Attrition)
ggplot(employee, aes(OverTime, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")

#Overall 28% of the employees are putting overtime. The percentage of attrition amongst those putting in overtime is close to 44% (127/289) vs 11% (110/944) for those not putting in overtime. Thus Overtime is contributing towards attrition.
```

#Monthly Income:
```{r}
summary(employee$MonthlyIncome)
MnthlyIncome <- cut(employee$MonthlyIncome, 10, include.lowest = TRUE, labels=c(1,2,3,4,5,6,7,8,9,10))
ggplot(employee, aes(MnthlyIncome, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#The attrition in absolute terms decreases as the salary increases, thus lower salary is contributing towards attrition.
```
#TotalWorkingYears
```{r}
summary(employee$TotalWorkingYears)
TtlWkgYrs <- cut(employee$TotalWorkingYears, 10, include.lowest = TRUE)
ggplot(employee, aes(TtlWkgYrs, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
#attrition decreases as the total number of working years increase. After an employee has spent 8-12 years in the company, his chances of attrition decrease.
```

#JobRole

```{r}
table(employee$JobRole)
table(employee$JobRole, employee$Attrition)
gplot <- ggplot(employee, aes(x = JobRole, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
gplot + theme(axis.text.x=element_text(angle=90, hjust=1))
 #Laboratory Technicians followed by the Sales Executives are contributing the maximum towards attrition. In percentage terms, Sales Representative are far ahead at 66%.
```

#Education field
```{r}
table(employee$EducationField)
table(employee$EducationField, employee$Attrition)
gplot2 <- ggplot(employee, aes(x = EducationField, ..count.., fill = factor(Attrition))) + geom_bar(position="dodge")
gplot2 + theme(axis.text.x=element_text(angle=90, hjust=1))
#The company has more employees with education field LifeScience
```

```{r}
ggplot(employee, aes(x=factor(Department), y=MonthlyIncome, color=factor(Attrition))) +
   geom_boxplot() +
   xlab("Department") +
   ylab("Monthly income") +
   scale_fill_discrete(guide=guide_legend(title="Attrition")) +
   theme_bw()


```

# sales department has the highest attrition factor.
```
